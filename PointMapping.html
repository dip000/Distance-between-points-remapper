
<html>
  <script type="text/javascript" src="Math.js"></script>
  <script type="text/javascript" src="PointsData.js"></script>
  <script type="text/javascript" src="Canvas.js"></script>
  <link rel="stylesheet" href="Stylesheet.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <table>
    <tbody>
      <tr>
        <td class="lateral">
          <textarea id="distances_text"></textarea>
          <br><button id="remap_button">(Re)Map distances</button>
        </td>
        <td class="main">
          <canvas id="canvas"></canvas>
        </td>
      </tr>
    </tbody>
  </table>

  </body>
  <script>

    let pointsData = new PointsData()
    let canvasData = new CanvasData(canvas)

    // Add point over the canvas and update text output
    canvasData.canvas.addEventListener("mousedown", (e)=>{
      let pos = canvasData.formatOutputPoint(e.offsetX, e.offsetY)
      pointsData.add(pos.x, pos.y)
      distances_text.value = pointsData.parseOutputFromDistances()
    })

    // Calculates 2D points from inputed 1D distances, then redraws the canvas using those 2D points
    remap_button.onclick = function(){
      pointsData.parseDistancesFromOutput( distances_text.value )
      let root = random(2)
      pointsData.remapPointsFromDistances( root )
      console.log("Points Remapped:", pointsData.points, ", root:",root)

      canvasData = new CanvasData(canvas)
      for(let p in pointsData.points){
        let pos = canvasData.formatInputPoint(pointsData.points[p].x, pointsData.points[p].y)
        canvasData.drawPoint(pos.x, pos.y)
      }
    }

    /*function animateRotationAround(target, pivot, time=1000, angle=360){
      let points = pointsData.points
      let update = setInterval(()=>{
        target = pivot.to(target).rotate(angle/time*10).add(pivot)

        canvasData = new CanvasData(canvas)
        canvasData.drawPoint(target.x, target.y)
        for(let p in points){
          canvasData.drawPoint(points[p].x, points[p].y)
        }
      }, 10)

      setTimeout(()=>{
        clearInterval(update)
      }, time)
    }*/

  </script>
</html>
