
<html>
  <script type="text/javascript" src="Math.js"></script>
  <script type="text/javascript" src="PointsData.js"></script>
  <script type="text/javascript" src="Canvas.js"></script>
  <link rel="stylesheet" href="Stylesheet.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <table>
    <tbody>
      <tr>
        <td class="lateral">
          <textarea id="distances_text"></textarea>
          <br><button id="remap_button">(Re)Map distances</button>
        </td>
        <td class="main">
          <canvas id="canvas"></canvas>
        </td>
      </tr>
    </tbody>
  </table>

  </body>
  <script>

    let pointsData = new PointsData()
    let canvasData = new CanvasData(canvas)
    let remapRoot = 0


    // Add point over the canvas and update text output
    canvasData.canvas.addEventListener("mousedown", (e)=>{
      let pos = canvasData.formatOutputPoint(e.offsetX, e.offsetY)
      pointsData.add(pos.x, pos.y)
      distances_text.value = pointsData.parseOutputFromDistances()
    })

    // Calculates 2D points from inputed 1D distances, then redraws the canvas using those 2D points
    remap_button.onclick = function(){
      remapRoot^=1 // toggle different solution roots
      pointsData.parseDistancesFromOutput( distances_text.value )
      pointsData.remapPointsFromDistances( remapRoot )
      console.log("Points Remapped:", pointsData.points, ", root:",remapRoot)

      canvasData.redraw(pointsData.points, canvasData.pointRadius)
    }

    // Scale canvas with mouse wheel
    canvasData.canvas.addEventListener('wheel', function(e){
      let scale = (e.deltaY < 0) ? Math.min(canvasData.pointRadius+1, 20) : Math.max(canvasData.pointRadius-1, 3)
      canvasData.redraw(pointsData.points, scale)
    })

  </script>
</html>
